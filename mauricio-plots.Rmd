---
title: "Creating plots in R using ggplot2"
author: 
  - Jodie Burchell
  - Mauricio Vargas Sepúlveda 帕夏
date: "`r Sys.Date()`"
output: 
      rmarkdown::html_vignette:
        css: css/entries.css
---

```{r setup, cache = FALSE, echo = FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(message = F, error = F, warning = F, comment = NA, fig.align = 'center', dpi = 100, fig.width=6, fig.height=5, tidy = F, cache.path = '.cache/', fig.path = 'fig/', tidy = FALSE)
```

## List of graphs:
* Scatterplot
* Weighted scatterplot
* Linear regression plot OK
* Lowess curve plot
* Line graph OK
* Area graph OK
* Bar graph OK
* Stacked bar graph OK
* Box plot
* Histogram
* Density plot
* Function curve

## Libraries

```{r libraries, cache=TRUE}
library(ggplot2)

# install.packages('ggthemes', dependencies = TRUE)
library(ggthemes)
library(extrafont)
#fonts()
#font_import(pattern="[O/o]fficina")
#font_import(pattern="[A/a]tlas")

library(scales)

library(plyr)
```

## Single linear regression plot

### Basic plot
```{r regression1, cache=TRUE}
charts.data <- read.csv("charts.csv")
charts.data <- charts.data[charts.data$product == "copper",]

p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data)
p6
```

### Adding trend line
```{r regression2, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data)
p6
```

### Modifying trend line (non-linear $\rightarrow$ linear trend line)
```{r regression3, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm')
p6
```

### Modifying trend line (linear $\rightarrow$ quadratic trend line)
```{r regression4, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2))
p6
```

### Modifying trend line (confidende interval $\rightarrow$ no confidence interval shown)
```{r regression5, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data) + 
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE)
p6
```

### Adjusting axis and adding title
```{r regression6, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), data = charts.data) + 
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million") 
p6
```

### Adjusting aesthetics

```{r regression7, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year), size = 4, colour = 'red', 
                            fill = 'red', data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, colour = 'blue', size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million")
p6
```

### Using white theme
```{r regression8, cache=TRUE}
p6 <- ggplot() + theme_bw() +
  geom_point(aes(y = export, x = year), size = 4, colour = 'red', 
                            fill = 'red', data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, colour = 'blue', size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million")
p6
```

### Using 'The Economist' theme 
```{r regression9, cache=TRUE}
p6 <- ggplot() + theme_economist() + scale_colour_economist() +
  theme(plot.title=element_text(family="OfficinaSanITC-Book"),
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_point(aes(y = export, x = year), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million")
p6
```

### Using 'Five Thirty Eight' theme 
```{r regression10, cache=TRUE}
p6 <- ggplot() + theme_fivethirtyeight() + scale_colour_fivethirtyeight() +
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_point(aes(y = export, x = year), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million")
p6
```

### Creating an XKCD style chart
```{r regression11, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

p6 <- ggplot() + 
  geom_point(aes(y = export, x = year), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million") +
    theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank()) +
  theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), panel.border = element_blank(), 
        panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p6
```

### Creating your own theme
```{r regression12, cache=TRUE}
p6 <- ggplot() + 
  geom_point(aes(y = export, x = year), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE, size = 1.5) +
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  ggtitle("Copper exports to China ($)") + labs(x="Year", y="USD million") +
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p6
```

## Double linear regression plot

### Basic plot
```{r regression13, cache=TRUE}
charts.data <- read.csv("charts.csv")

p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product), data = charts.data)
p6
```

### Adding trend line
```{r regression14, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product), data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product), data = charts.data)
p6
```

### Modifying trend line (non-linear $\rightarrow$ linear trend line)
```{r regression15, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product), data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product), data = charts.data, method = 'lm')
p6
```

### Modifying trend line (linear $\rightarrow$ quadratic trend line)
```{r regression16, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product), data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2))
p6
```

### Modifying trend line (confidende interval $\rightarrow$ no confidence interval shown)
```{r regression17, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product), data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product), data = charts.data, method = 'lm', 
              formula = y ~ poly(x, 2), se = FALSE)
p6
```

### Adjusting axis, adding legends and title
```{r regression18, cache=TRUE}
p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product, 
                                colour = factor(product)), data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
    ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") 
p6
```

### Adjusting aesthetics
```{r regression19, cache=TRUE}
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p6 <- ggplot() + geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p6
```

### Using white theme
```{r regression20, cache=TRUE}
p6 <- ggplot() + theme_bw() +
  geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p6
```

### Using 'The Economist' theme 
```{r regression21, cache=TRUE}
p6 <- ggplot() + theme_economist() + scale_colour_economist() +
  theme(plot.title=element_text(family="OfficinaSanITC-Book"),
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p6
```

### Using 'Five Thirty Eight' theme 
```{r regression22, cache=TRUE}
p6 <- ggplot() + theme_fivethirtyeight() + scale_colour_fivethirtyeight() +
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p6
```

### Creating an XKCD style chart
```{r regression23, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

fill <- c("#56B4E9", "#ff69b4")

p6 <- ggplot() + 
  geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  scale_x_continuous(breaks=seq(2006,2014,1)) +
  ggtitle("Exports to China ($)") + labs(x="Year", y="USD million") +
    theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank()) +
  scale_color_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), panel.border = element_blank(), 
        panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white"))
p6
```

### Creating your own theme
```{r regression24, cache=TRUE}
fill <- c("#40b8d0", "#b2d183")

p7 <- ggplot() + 
  geom_point(aes(y = export, x = year, group = product, colour = factor(product), 
                                shape = factor(product)), size = 4, data = charts.data) +
  geom_smooth(aes(y = export, x = year, group = product, colour = factor(product)), 
              data = charts.data, method = 'lm', formula = y ~ poly(x, 2), se = FALSE, 
              size = 1.5) +
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Exports to China ($)") + 
  scale_color_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"),
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white"))
p7
```

## Line graph

### Basic graph
```{r line1, cache=TRUE}
charts.data <- read.csv("charts.csv")

p7 <- ggplot() + geom_line(aes(y = export, x = year, colour = product), data = charts.data, 
                           stat="identity")
p7
```

### Adjusting line width
```{r line2, cache=TRUE}
charts.data <- read.csv("charts.csv")

p7 <- ggplot() + geom_line(aes(y = export, x = year, colour = product), size=1.5, 
                           data = charts.data, stat="identity")
p7
```

### Changing variables display
```{r line3, cache=TRUE}
charts.data <- as.data.frame(charts.data)
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p7 <- ggplot() + geom_line(aes(y = export, x = year, colour = product), size=1.5, 
                           data = charts.data, stat="identity") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p7
```

### Adjusting x-axis scale
```{r line4, cache=TRUE}
p7 <- p7 + scale_x_continuous(breaks=seq(2006,2014,1))
p7
```

### Adjusting axis labels & adding title
```{r line5, cache=TRUE}
p7 <- p7 + ggtitle("Composition of Exports to China ($)") + labs(x="Year", y="USD million") 
p7
```

### Adjusting color palette
```{r line6, cache=TRUE}
colour <- c("#5F9EA0", "#E1B378")
p7 <- p7 + scale_colour_manual(values=colour)
p7
```

### Using white theme
```{r line7, cache=TRUE}
p7 <- ggplot() + theme_bw() +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_colour_manual(values=colour)
p7
```

### Using 'The Economist' theme 
```{r line8, cache=TRUE}
p7 <- ggplot() + theme_economist() + scale_colour_economist() +
  theme(plot.title=element_text(family="OfficinaSanITC-Book"),
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p7
```

### Using 'Five Thirty Eight' theme 
```{r line9, cache=TRUE}
p7 <- ggplot() + theme_fivethirtyeight() + scale_colour_fivethirtyeight() +
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p7
```

### Creating an XKCD style chart
```{r line10, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

fill <- c("#56B4E9", "#ff69b4")

p8 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_color_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), panel.border = element_blank(), 
        panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white")) 
p8
```

### Creating your own theme
```{r line11, cache=TRUE}
fill <- c("#40b8d0", "#b2d183")

p7 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_colour_manual(values=colour) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"),
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white")) 
p7
```

## Area graph

### Basic graph
```{r area1, cache=TRUE}
charts.data <- read.csv("charts.csv")

p8 <- ggplot() + geom_area(aes(y = export, x = year, fill = product), data = charts.data, 
                           stat="identity")
p8
```

### Adjusting legend position
```{r area2, cache=TRUE}
charts.data <- ddply(charts.data, .(year), transform, pos = cumsum(export) - (0.5 * export))

p8 <- p8 + theme(legend.position="bottom", legend.direction="horizontal", 
                 legend.title = element_blank())
p8
```

### Changing variables display
```{r area3, cache=TRUE}
charts.data <- as.data.frame(charts.data)
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p8 <- ggplot() + geom_area(aes(y = export, x = year, fill = product), data = charts.data,
                           stat="identity") + theme(legend.position="bottom",
                                                    legend.direction="horizontal",
                                                    legend.title = element_blank())
p8
```

### Adjusting x-axis scale
```{r area4, cache=TRUE}
p8 <- p8 + scale_x_continuous(breaks=seq(2006,2014,1))
p8
```

### Adjusting axis labels & adding title
```{r area5, cache=TRUE}
p8 <- p8 + ggtitle("Composition of Exports to China ($)") + labs(x="Year", y="USD million") 
p8
```

### Adjusting color palette
```{r area6, cache=TRUE}
fill <- c("#5F9EA0", "#E1B378")
p8 <- p8 + scale_fill_manual(values=fill)
p8
```

### Using white theme
```{r area7, cache=TRUE}
p8 <- ggplot() + theme_bw() +
  geom_area(aes(y = export, x = year, fill = product), data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill)
p8
```

### Using 'The Economist' theme 
```{r area8, cache=TRUE}
p8 <- ggplot() + theme_economist() + scale_fill_economist() +
  theme(plot.title=element_text(family="OfficinaSanITC-Book"),
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_area(aes(y = export, x = year, fill = product), data = charts.data, stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p8
```

### Using 'Five Thirty Eight' theme 
```{r area9, cache=TRUE}
p8 <- ggplot() + theme_fivethirtyeight() + scale_fill_fivethirtyeight() +
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_area(aes(y = export, x = year, fill = product), data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p8
```

### Creating an XKCD style chart
```{r area10, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

fill <- c("#56B4E9", "#F0E442")

p8 <- ggplot() + 
  geom_area(aes(y = export, x = year, fill = product), data = charts.data, stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), panel.border = element_blank(), 
        panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p8
```

### Creating your own theme
```{r area11, cache=TRUE}
fill <- c("#40b8d0", "#b2d183")

p8 <- ggplot() + 
  geom_area(aes(y = export, x = year, fill = product), data = charts.data, 
            stat="identity") + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p8
```

## Bar graph

### Basic graph
```{r bar1, cache=TRUE}
charts.data <- read.csv("charts.csv")

p9 <- ggplot() + geom_bar(aes(y = export, x = year, fill = product), data = charts.data, 
                          stat="identity")
p9
```

### Adding data labels
```{r bar2, cache=TRUE}
p9 <- p9 + geom_text(data=charts.data, aes(x = year, y = export, label = export), size=4)
p9
```

### Adjusting data labels position
```{r bar3, cache=TRUE}
charts.data <- ddply(charts.data, .(year), transform, pos = cumsum(export) - (0.5 * export))

p9 <- ggplot() + geom_bar(aes(y = export, x = year, fill = product), data = charts.data, 
                          stat="identity") 
p9 <- p9 + geom_text(data=charts.data, aes(x = year, y = pos, label = export), size=4)
p9
```

### Adjusting legend position
```{r bar4, cache=TRUE}
charts.data <- ddply(charts.data, .(year), transform, pos = cumsum(export) - (0.5 * export))

p9 <- p9 + theme(legend.position="bottom", legend.direction="horizontal", 
                 legend.title = element_blank())
p9
```

### Changing variables display
```{r bar5, cache=TRUE}
charts.data <- as.data.frame(charts.data)
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p9 <- ggplot() + geom_bar(aes(y = export, x = year, fill = product), data = charts.data, 
                          stat="identity") 
p9 <- p9 + geom_text(data=charts.data, aes(x = year, y = pos, label = export, size=4), 
                     show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p9
```

### Adjusting x-axis scale
```{r bar6, cache=TRUE}
p9 <- p9 + scale_x_continuous(breaks=seq(2006,2014,1))
p9
```

### Adjusting axis labels & adding title
```{r bar7, cache=TRUE}
p9 <- p9 + ggtitle("Composition of Exports to China ($)") + labs(x="Year", y="USD million") 
p9
```

### Adjusting color palette
```{r bar8, cache=TRUE}
fill <- c("#5F9EA0", "#E1B378")
p9 <- p9 + scale_fill_manual(values=fill)
p9
```

### Using white theme
```{r bar9, cache=TRUE}
p9 <- ggplot() + theme_bw() +
  geom_bar(aes(y = export, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = export, size=4), show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill)
p9
```

### Using 'The Economist' theme 
```{r bar10, cache=TRUE}
p9 <- ggplot() + theme_economist() + scale_fill_economist() +
  theme(plot.title=element_text(family="OfficinaSanITC-Book"), 
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_bar(aes(y = export, x = year, fill = product), data = charts.data, 
           stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = export), colour="white", size = 4,
            family = "OfficinaSanITC-Book", show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p9
```

### Using 'Five Thirty Eight' theme 
```{r bar11, cache=TRUE}
p9 <- ggplot() + theme_fivethirtyeight() + scale_fill_fivethirtyeight() + 
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_bar(aes(y = export, x = year, fill = product), data = charts.data, 
           stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = export), colour="white", size = 3.5,
            family = "Atlas Grotesk Medium", show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)")
p9
```

### Creating an XKCD style chart
```{r bar12, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

fill <- c("#56B4E9", "#F0E442")

p9 <- ggplot() + 
  geom_bar(aes(y = export, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = export), colour="black", 
            family="xkcd-Regular", size = 4, show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p9
```

### Creating your own theme
```{r bar13, cache=TRUE}
fill <- c("#40b8d0", "#b2d183")

p9 <- ggplot() + 
  geom_bar(aes(y = export, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = export), colour="black", 
            family="AdobeHeitiStd-Regular", size = 4, show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"),
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p9
```

## Stacked bar graph

### Basic graph
```{r bar14, cache=TRUE}
charts.data <- read.csv("charts.csv")

p10 <- ggplot() + geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, 
                           stat="identity")
p10
```

### Adding data labels
```{r bar15, cache=TRUE}
p10 <- p10 + geom_text(data=charts.data, aes(x = year, y = percentage, 
                                             label = paste0(percentage,"%")), size=4)
p10
```

### Adjusting data labels position
```{r bar16, cache=TRUE}
charts.data <- ddply(charts.data, .(year), 
                     transform, pos = cumsum(percentage) - (0.5 * percentage))

p10 <- ggplot() + geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, 
                           stat="identity")
p10 <- p10 + geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), 
                       size=4)
p10
```

### Adjusting legend position
```{r bar17, cache=TRUE}
p10 <- p10 + theme(legend.position="bottom", legend.direction="horizontal", 
                   legend.title = element_blank())
p10
```

### Changing variables display
```{r bar18, cache=TRUE}
charts.data <- as.data.frame(charts.data)
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p10 <- ggplot() + geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, 
                           stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, 
                                  label = paste0(percentage,"%")), size=4) +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p10
```

### Adjusting x-axis scale
```{r bar19, cache=TRUE}
p10 <- p10 + scale_x_continuous(breaks=seq(2006,2014,1))
p10
```

### Adjusting axis, title & units
```{r bar20, cache=TRUE}
p10 <- p10 + labs(x="Year", y="Percentage") + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) +
  ggtitle("Composition of Exports to China (%)") 
p10
```

### Adjusting color palette
```{r bar21, cache=TRUE}
fill <- c("#5F9EA0", "#E1B378")
p10 <- p10 + scale_fill_manual(values=fill)
p10
```

### Using white theme
```{r bar22, cache=TRUE}
p10 <- ggplot() + theme_bw() +
  geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), size=4) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) + 
  labs(x="Year", y="Percentage") + 
  ggtitle("Composition of Exports to China (%)")
p10
```

### Using 'The Economist' theme 
```{r bar23, cache=TRUE}
p10 <- ggplot() + theme_economist() + scale_fill_economist() + 
  theme(plot.title=element_text(family="OfficinaSanITC-Book"), 
        text=element_text(family="OfficinaSanITC-Book")) +
  geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), 
            colour="white", family="OfficinaSanITC-Book", size=4) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) + 
  labs(x="Year", y="Percentage") + 
  ggtitle("Composition of Exports to China (%)")
p10
```

### Using 'Five Thirty Eight' theme 
```{r bar24, cache=TRUE}
p10 <- ggplot() + theme_fivethirtyeight() + scale_fill_fivethirtyeight() +   
  theme(plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light")) +
  geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), 
            colour="white", family="Atlas Grotesk Medium", size=4) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) + 
  labs(x="Year", y="Percentage") + 
  ggtitle("Composition of Exports to China (%)")
p10
```

### Creating an XKCD style chart
```{r bar25, cache=TRUE}
#font_import(pattern="[X/x]kcd")
#fonts()

fill <- c("#56B4E9", "#F0E442")

p10 <- ggplot() + 
  geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), 
            colour="black", family="xkcd-Regular", size = 5, show_guide = F) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) + 
  labs(x="Year", y="Percentage") + 
  ggtitle("Composition of Exports to China (%)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p10
```

### Creating your own theme
```{r bar26, cache=TRUE}
fill <- c("#40b8d0", "#b2d183")

p10 <- ggplot() + 
  geom_bar(aes(y = percentage, x = year, fill = product), data = charts.data, stat="identity") + 
  geom_text(data=charts.data, aes(x = year, y = pos, label = paste0(percentage,"%")), 
            colour="black", family="AdobeHeitiStd-Regular", size=4) + 
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank()) + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  scale_y_continuous(labels = dollar_format(suffix = "%", prefix = "")) + 
  labs(x="Year", y="Percentage") + 
  ggtitle("Composition of Exports to China (%)") + 
  scale_fill_manual(values=fill) + 
  theme(axis.line = element_line(size=1, colour = "black"), 
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank()) + 
  theme(plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma"),
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10)) 
p10
```
