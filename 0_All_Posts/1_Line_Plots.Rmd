# LINE

The first thing to do is load in the data and libraries, as below:

```{r line_load, cache=TRUE}
library(ggplot2)
library(ggthemes)
library(extrafont)

charts.data <- read.csv("copper-data-for-tutorial.csv")
```

In this part, we will work towards creating the line plot below. We will take you from a basic line plot and explain all the customisations we add to the code step-by-step.

```{r line_final, echo=FALSE, cache=TRUE}
library(ggplot2)

library(ggthemes)
library(extrafont)

charts.data.2 <- read.csv("copper-data-for-tutorial.csv")
charts.data.2 <- as.data.frame(charts.data.2)
charts.data.2$product <- factor(charts.data.2$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

colour <- c("#40b8d0", "#b2d183")

p1 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_colour_manual(values=colour) + 
  theme(axis.line.x = element_line(size=.5, colour = "black"), 
        axis.line.y = element_line(size=.5, colour = "black"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white"),
        legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank(),
        panel.grid.major = element_line(colour = "#d3d3d3"), panel.grid.minor = element_blank(), 
        panel.border = element_blank(), panel.background = element_blank(),
        plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma")) 
p1
```

## Basic graph
In order to initialise a plot we tell ggplot that `charts.data` is our data, and specify the variables on each axis. We then instruct ggplot to render this as a line plot by adding the `geom_line` command.

```{r line_1, cache=TRUE}
p1 <- ggplot() + geom_line(aes(y = export, x = year, colour = product), 
                           data = charts.data, stat="identity")
p1
```

## Adjusting line width
To change the line width, we add a `size` argument to `geom_line`.

```{r line_2, cache=TRUE}
p1 <- ggplot() + geom_line(aes(y = export, x = year, colour = product), size=1.5, 
                           data = charts.data, stat="identity")
p1
```

## Changing variables display
To change the variables displayed name, we need to re-factor our data labels in `charts.data` data frame. Then we move the legend to the bottom using the `theme` command.

```{r line_3, cache=TRUE}
charts.data <- as.data.frame(charts.data)
charts.data$product <- factor(charts.data$product, levels = c("copper","others"), 
                              labels = c("Copper","Pulp wood, Fruit, Salmon & Others"))

p1 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, stat="identity") +
  theme(legend.position="bottom", legend.direction="horizontal", legend.title = element_blank())
p1
```

## Adjusting x-axis scale
To change the axis tick marks, we use the `scale_x_continuous` and/or `scale_y_continuous` commands.

```{r line_4, cache=TRUE}
p1 <- p1 + scale_x_continuous(breaks=seq(2006,2014,1))
p1
```

## Adjusting axis labels & adding title
To add a title, we include the option `ggtitle` and include the name of the graph as a string argument, and to change the axis names we use the `labs` command.

```{r line_5, cache=TRUE}
p1 <- p1 + ggtitle("Composition of Exports to China ($)") + labs(x="Year", y="USD million") 
p1
```

## Adjusting color palette
To change the colours, we use the `scale_colour_manual` command.

```{r line_6, cache=TRUE}
colour <- c("#5F9EA0", "#E1B378")
p1 <- p1 + scale_colour_manual(values=colour)
p1
```

## Using the white theme
We'll start using a simple theme customisation made adding `theme_bw() ` after `ggplot()`. That theme argument can be modified to use different themes.

```{r line_7, cache=TRUE}
p1 <- ggplot() +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_colour_manual(values=colour) +
  theme_bw() +
  theme(legend.position="bottom", 
        legend.direction="horizontal", 
        legend.title = element_blank()) 
p1
```

## Creating an XKCD style chart
Of course, you may want to create your own themes as well. `ggplot2` allows for a very high degree of customisation, including allowing you to use imported fonts. Below is an example of a theme Mauricio was able to create which mimics the visual style of [XKCD](http://xkcd.com/). In order to create this chart, you first need to import the XKCD font, install it on your machine and load it into R using the `extrafont` package.
These instructions are taken from [here](https://www.google.com.au/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0ahUKEwiWzafchdPJAhVBpJQKHe_LDT8QFggbMAA&url=https%3A%2F%2Fcran.r-project.org%2Fweb%2Fpackages%2Fxkcd%2Fvignettes%2Fxkcd-intro.pdf&usg=AFQjCNE-KciGY14e-Q1buYIVmTFC0ht__Q&sig2=DZUwkvIHwfNWtTtkcz94jg):

```{r line_importing_font_xkcd, eval=FALSE}
library(extrafont)

download.file("http://simonsoftware.se/other/xkcd.ttf", 
              dest="xkcd.ttf", mode="wb")
system("mkdir ~/.fonts")
system("cp xkcd.ttf  ~/.fonts")
font_import(paths = "~/.fonts", pattern="[X/x]kcd")
fonts()
loadfonts()
```

You can then create your graph:

```{r line_8, cache=TRUE}
fill <- c("#56B4E9", "#ff69b4")

p1 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_color_manual(values=fill) + 
  theme(axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        axis.line.x = element_line(size=.5, colour = "black"),
        axis.line.y = element_line(size=.5, colour = "black"),
        legend.key=element_rect(fill="white", colour="white"),
        legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(), panel.border = element_blank(), 
        panel.background = element_blank(),
        plot.title=element_text(family="xkcd-Regular"), text=element_text(family="xkcd-Regular")) 
p1
```

## Using 'The Economist' theme 
There are a wider range of pre-built themes available as part of the `ggthemes` package (more information on these [here](https://cran.r-project.org/web/packages/ggthemes/vignettes/ggthemes.html)). Below we've applied `theme_economist()`, which approximates graphs in the Economist magazine. It is also important that the font change argument inside `theme` is optional and it's only to obtain a more similar result compared to the original. For an exact result you need 'Officina Sans' which is a commercial font and is available [here](http://www.myfonts.com/fonts/itc/officina-sans/).

```{r line_9, cache=TRUE, eval=TRUE}
p1 <- ggplot() +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") +
  theme_economist() + scale_colour_economist() +
  theme(axis.line.x = element_line(size=.5, colour = "black"), 
        axis.line.y = element_line(size=.5, colour = "black"),
        legend.position="bottom", 
        legend.direction="horizontal", 
        legend.title = element_blank(),
        plot.title=element_text(family="OfficinaSanITC-Book"),
        text=element_text(family="OfficinaSanITC-Book")) 
p1
```

<!--
## Using 'Five Thirty Eight' theme 
Below we've applied `theme_fivethirtyeight()`, which approximates graphs in the nice [FiveThirtyEight](http://fivethirtyeight.com/) website. Again, it is also important that the font change is optional and it's only to obtain a more similar result compared to the original. For an exact result you need 'Atlas Grotesk' which is a commercial font and is available [here](https://commercialtype.com/catalog/atlas).

```{r line_10, cache=TRUE, eval=TRUE}
p1 <- ggplot() + theme_fivethirtyeight() + scale_colour_fivethirtyeight() +
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") +
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") +
  theme(legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank(),
        plot.title=element_text(family="Atlas Grotesk Medium"), 
        text=element_text(family="Atlas Grotesk Light"))  
p1
```
-->

## Creating your own theme
As before, you can modify your plots a lot as `ggplot2` allows many customisations. Here we present our original result shown at the top of page.

```{r line_11, cache=TRUE}
colour <- c("#40b8d0", "#b2d183")

p1 <- ggplot() + 
  geom_line(aes(y = export, x = year, colour = product), size=1.5, data = charts.data, 
            stat="identity") + 
  scale_x_continuous(breaks=seq(2006,2014,1)) + 
  labs(x="Year", y="USD million") + 
  ggtitle("Composition of Exports to China ($)") + 
  scale_colour_manual(values=colour) + 
  theme(axis.line.x = element_line(size=.5, colour = "black"), 
        axis.line.y = element_line(size=.5, colour = "black"), 
        axis.text.x=element_text(colour="black", size = 10), 
        axis.text.y=element_text(colour="black", size = 10),
        legend.key=element_rect(fill="white", colour="white"),
        legend.position="bottom", legend.direction="horizontal", 
        legend.title = element_blank(),
        panel.grid.major = element_line(colour = "#d3d3d3"), 
        panel.grid.minor = element_blank(), 
        panel.border = element_blank(), 
        panel.background = element_blank(),
        plot.title = element_text(size = 14, family = "Tahoma", face = "bold"), 
        text=element_text(family="Tahoma")) 
p1
```
